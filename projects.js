const projectsData = [
  {
    group: "Therapeutic",
    images: ["img/helthcare/iranzamin/main-pic.jpg", "img/helthcare/iranzamin/001.jpg", "img/helthcare/iranzamin/002.jpg"],
    title: "Iranzamin Hospital – 500 beds",
    description: "Iranzamin Bank – Tehran",
    area: "area : 50000m²"
  },
  {
    group: "Therapeutic",
    images: ["img/helthcare/gelan/main-pic.jpg", "img/helthcare/gelan/01.jpg", "img/helthcare/gelan/02.jpg"],
    title: "Gelan Hospital – 600 beds",
    description: "ETCA International Company KENYA – Nairobi"
  },
  {
    group: "Therapeutic",
    images: ["img/helthcare/ariya/main-pic.jpg", "img/helthcare/ariya/01.jpg", "img/helthcare/ariya/02.jpg"],
    title: "New Aria Hospital – 160 beds",
    description: "Aria Hospital – Tehran"
  },
  {
    group: "Therapeutic",
    images: ["img/helthcare/shafa/main-pic.jpg", "img/helthcare/shafa/02.jpg"],
    title: "Shafa Limited Surgery Center",
    description: "Dr Salehipour – Bandar Abbas",
    area: "area : 10000m²"
  },
    {
    group: "Therapeutic",
    images: ["img/helthcare/Milad/main-pic.jpg", "img/helthcare/Milad/01.jpg","img/helthcare/Milad/02.jpg"],
    title: "Milad Hospital – 300 beds Urmia",
    description: "Peshgaman Salamat Saz Urima.Co ",
    area: "area : 40000m²"
  },
     {
    group: "Therapeutic",
    images: ["img/helthcare/Barkat/main-pic.jpg"],
    title: "Barkat Hospital–600 beds Tehran",
    description: "Joint Venture.WeMoCo in Austria ",
    area: "area : 140000m²"
  },
     {
    group: "Therapeutic",
     images: ["img/helthcare/Rajai/main-pic.jpg", "img/helthcare/Rajai/01.jpg","img/helthcare/Rajai/02.jpg"],
    title: "Shahid Rajai Hospital–1200 beds",
    description: "Shahid Rajai Hospital – Tehran",
    area: "area : 180000m²"
  },
     {
    group: "Therapeutic",
     images: ["img/helthcare/Zahedan/main-pic.jpg", "img/helthcare/Zahedan/01.jpg","img/helthcare/Zahedan/02.jpg"],
    title: "Zahedan Pars Hospital–160 beds",
    description: "Pars Teb Company – Zahedan",
    area: "area : 30000m²"
  },
      {
    group: "Therapeutic",
     images: ["img/helthcare/Sina/main-pic.jpg", "img/helthcare/Sina/01.jpg"],
    title: "Arak Sina Hospital – 160 beds",
    description: "Mavara Darman Company – Arak",
    area: "area : 30000m²"
  },
      {
    group: "Therapeutic",
     images: ["img/helthcare/ghaem/main-pic.jpg", "img/helthcare/ghaem/01.jpg","img/helthcare/ghaem/02.jpg"],
    title: "Ghaem Hospital – 160 beds",
    description: "Gilva Azar Iranian – Rasht",
    area: "area : 20000m²"
  },
       {
    group: "Therapeutic",
     images: ["img/helthcare/Bukha/main-pic.jpg", "img/helthcare/Bukha/01.jpg","img/helthcare/Bukha/02.jpg"],
    title: "Bukha Hospital – 50 beds",
    description: "Oman Ministry of Health – Oman",
    area: "area : 14500m²"
  },
       {
    group: "Therapeutic",
     images: ["img/helthcare/spanda/main-pic.jpg", "img/helthcare/spanda/01.jpg","img/helthcare/spanda/02.jpg"],
    title: "Spadana Hospital – 250 beds",
    description: "Amin Teb Sepano Company – Isafahan",
    area: "area : 50000m²"
  },
       {
    group: "Therapeutic",
     images: ["img/helthcare/Mahut/main-pic.jpg", "img/helthcare/Mahut/01.jpg","img/helthcare/Mahut/02.jpg"],
    title: "Mahout Hospital – 50 beds",
    description: "Oman Ministry of Health–Muscat,Oman",
    area: "area : 14000m²"
  },
       {
    group: "Therapeutic",
     images: ["img/helthcare/Golestan/main-pic.jpg", "img/helthcare/Golestan/01.jpg","img/helthcare/Golestan/02.jpg"],
    title: "Golestan Polyclinic and Emergency",
    description: "Iran Oil and Gas Company – Shiraz",
    area: "area : 55000m² – 32 beds"
  },
       {
    group: "Therapeutic",
     images: ["img/helthcare/Alzahra/main-pic.jpg", "img/helthcare/Alzahra/01.jpg","img/helthcare/Alzahra/02.jpg"],
    title: "Al-Zahra Ophthalmology Hospital ",
    description: "Zahedan University – Zahedan",
    area: "area : 6000m² "
  },
      {
    group: "Therapeutic",
     images: ["img/helthcare/Rasht/main-pic.jpg", "img/helthcare/Rasht/01.jpg","img/helthcare/Rasht/02.jpg"],
    title: "Limited Surgical Centre ",
    description: "Dr Salari – Rasht",
    area: "area : 14000m² "
  },
     {
    group: "Therapeutic",
     images: ["img/helthcare/pasdaran/main-pic.jpg", "img/helthcare/pasdaran/01.jpg","img/helthcare/pasdaran/02.jpg"],
    title: "Pasdaran Melal Cancer Center ",
    description: "Vista Darman Melal – Tehran",
    area: "area : 7162m² "
  },
    {
    group: "Therapeutic",
     images: ["img/helthcare/Kerman/main-pic.jpg", "img/helthcare/Kerman/01.jpg","img/helthcare/Kerman/02.jpg"],
    title: "Pars Hospital – 160 beds ",
    description: "Paya Darman Company – Kerman",
    area: "area : 28000m² "
  },
   {
    group: "Therapeutic",
     images: ["img/helthcare/Gaem-karaj/main-pic.jpg", "img/helthcare/Gaem-karaj/01.jpg","img/helthcare/Gaem-karaj/02.jpg"],
    title: "Ghaem Hospital – 120 beds ",
    description: "Mehrpad Medical Group – Karaj",
    area: "area : 16000m² "
  },
   {
    group: "Therapeutic",
     images: ["img/helthcare/ghalb-rajai/main-pic.jpg", "img/helthcare/ghalb-rajai/01.jpg","img/helthcare/ghalb-rajai/02.jpg"],
    title: "Rajai Polyclinics ",
    description: "Rajai Hospital – Tehran",
    area: "area : 15000m² "
  },
  {
    group: "Therapeutic",
     images: ["img/helthcare/Melal/main-pic.jpg", "img/helthcare/Melal/01.jpg","img/helthcare/Melal/02.jpg"],
    title: "Melal Hospital- 160 beds ",
    description: "Vista Darman Melal – Karaj",
    area: "area : 30000m² "
  },
   {
    group: "Therapeutic",
     images: ["img/helthcare/Reserch-center/main-pic.jpg", "img/helthcare/Reserch-center/01.jpg","img/helthcare/Reserch-center/02.jpg"],
    title: "Rajai Research Center ",
    description: "Rajai Hospital – Tehran",
    area: "area : 3000m² "
  },
     {
    group: "Industrial",
     images: ["img/Industrial/pars-sinohe/main-pic.jpg", "img/Industrial/pars-sinohe/01.jpg","img/Industrial/pars-sinohe/02.jpg"],
    title: "Pars Sinohe pad Company Factory ",
    description: "Pars Sinohe pad Company – Damaavand",
    area: "area : 14613m² "
  },
     {
    group: "Industrial",
     images: ["img/Industrial/nilper/main-pic.jpg", "img/Industrial/nilper/01.jpg","img/Industrial/nilper/02.jpg"],
    title: "Nilper Factory ",
    description: "Nilper Company – Parand",
    area: "area : 10000m² "
  },
     {
    group: "Industrial",
     images: ["img/Industrial/faraso/main-pic.jpg", "img/Industrial/faraso/01.jpg","img/Industrial/faraso/02.jpg"],
    title: "Farassoo Factory ",
    description: "Farasso – Parand",
    area: "area : 3000m² "
  },
    {
    group: "Residential",
     images: ["img/Residential/kelardasht/main-pic.jpg", "img/Residential/kelardasht/01.jpg","img/Residential/kelardasht/02.jpg"],
    title: "Kelardasht Villa  ",
    description: "Dr Fallahi – Tehran ",
    area: "area : 300m² "
  },
   {
    group: "Residential",
     images: ["img/Residential/masghat/main-pic.jpg", "img/Residential/masghat/01.jpg","img/Residential/masghat/02.jpg"],
    title: "Residential Complex  ",
    description: "Alvatani Co. – Oman ",
    area: "area : 400m² "
  },
   {
    group: "Residential",
     images: ["img/Residential/Alef/main-pic.jpg", "img/Residential/Alef/01.jpg","img/Residential/Alef/02.jpg"],
    title: "Alef House  ",
    description: "Mr Agha Hosseini – Tehran ",
    area: "area : 3500m² "
  },
     {
    group: "Residential",
     images: ["img/Residential/Esfahan/main-pic.jpg", "img/Residential/Esfahan/01.jpg","img/Residential/Esfahan/02.jpg"],
    title: "Alef House  ",
    description: "Mr Agha Hosseini – Tehran ",
    area: "area : 3500m² "
  },
     {
    group: "Residential",
     images: ["img/Residential/Bumusa/main-pic.jpg", "img/Residential/Bumusa/01.jpg","img/Residential/Bumusa/02.jpg"],
    title: "Bumosa Residential Complex  ",
    description: "Ministry of Road and Urbanism-Bumusa ",
    area: "area : 3500m² "
  },
       {
    group: "Administrative",
     images: ["img/Administrative/Maliati-zahedan/main-pic.jpg", "img/Administrative/Maliati-zahedan/01.jpg","img/Administrative/Maliati-zahedan/02.jpg"],
    title: "Zahedan Tax Official Building  ",
    description: "Ministry of Economy – Zahedan ",
    area: "area : 15283m² "
  },
       {
    group: "Administrative",
     images: ["img/Administrative/EIDC/main-pic.jpg", "img/Administrative/EIDC/01.jpg",],
    title: "EIDC Head Office & Pardis Tech Park  ",
    description: "Electronics Industrial Development–Tehran ",
    area: "area : 1400m² "
  },
     {
    group: "Service",
     images: ["img/Service/talab/main-pic.jpg", "img/Service/talab/01.jpg","img/Service/talab/02.jpg"],
    title: "EIDC Head Office & Pardis Tech Park  ",
    description: "Electronics Industrial Development–Tehran ",
    area: "area : 1400m² "
  },
       {
    group: "Service",
     images: ["img/Service/Taraz/main-pic.jpg", "img/Service/Taraz/01.jpg","img/Service/Taraz/02.jpg"],
    title: "Taaraz Rest Area – Tehran  ",
    description: "Hemmat Freeway Construction & Admin ",
    area: "area : 6650m² "
  },
       {
    group: "Service",
     images: ["img/Service/North-Taaraz/main-pic.jpg", "img/Service/North-Taaraz/01.jpg","img/Service/North-Taaraz/02.jpg"],
    title: "North Taaraz Rest Area – Tehran  ",
    description: "Hemmat Freeway Construction & Admin ",
    area: "area : 9580m² "
  },
         {
    group: "Service",
     images: ["img/Service/South-Taaraz/main-pic.jpg", "img/Service/South-Taaraz/01.jpg","img/Service/South-Taaraz/02.jpg"],
    title: "North Taaraz Rest Area – Tehran  ",
    description: "Hemmat Freeway Construction & Admin ",
    area: "area : 9580m² "
  },
  
];

let currentImages = [];
let currentIndex = 0;
let currentTitle = "";
let currentDescription = "";

function renderProjects(data) {
  data.forEach(project => {
    const containerId = project.group.toLowerCase() + '-projects';
    const container = document.getElementById(containerId);
    if (!container) return;

    const projectBox = document.createElement('div');
    projectBox.className = 'ui-projects';

    const imgDiv = document.createElement('div');
    imgDiv.className = 'ui__projects__img';

    const mainImg = document.createElement('img');
    mainImg.src = project.images[0];
    mainImg.alt = project.title;
    mainImg.className = 'img_projects popup-img';
    mainImg.addEventListener('click', () => openModal(project.images, project.title, project.description));
    imgDiv.appendChild(mainImg);

    const title = document.createElement('div');
    title.className = 'ui-projects_subtext';
    title.textContent = project.title;

    const desc = document.createElement('div');
    desc.className = 'projects_text';
    desc.textContent = project.description;

    const area = document.createElement('div');
    area.className = 'projects_text_area';
    area.textContent = project.area || '';

    projectBox.appendChild(imgDiv);
    projectBox.appendChild(title);
    projectBox.appendChild(desc);
    projectBox.appendChild(area);
    container.appendChild(projectBox);
  });
}

const elevatorBtn = document.getElementById('elevatorBtn');
const sec_projects1 = Array.from(document.querySelectorAll('section'));

// نمایش دکمه وقتی اسکرول زیاد شد
window.addEventListener('scroll', () => {
  if (window.scrollY > window.innerHeight * 0.8) {
    elevatorBtn.classList.add('show');
  } else {
    elevatorBtn.classList.remove('show');
  }
});

// کلیک روی دکمه: اسکرول به سکشن قبلی
elevatorBtn.addEventListener('click', () => {
  const currentScroll = window.scrollY;

  for (let i = sections.length - 1; i >= 0; i--) {
    if (sections[i].offsetTop < currentScroll - 20) {
      sections[i].scrollIntoView({ behavior: 'smooth' });
      break;
    }
  }
});

function openModal(images, title, description) {
  currentImages = images;
  currentIndex = 0;
  currentTitle = title;
  currentDescription = description;
  updateModalImage();

  const glass = document.getElementById("glass");
  glass.classList.remove("hidden");
  setTimeout(() => {
    glass.classList.add("show");
  }, 10);
}

function closeModal() {
  const glass = document.getElementById("glass");
  glass.classList.remove("show");
  setTimeout(() => {
    glass.classList.add("hidden");
  }, 400);
}

function nextImage() {
  if (currentImages.length === 0) return;
  currentIndex = (currentIndex + 1) % currentImages.length;
  updateModalImage();
}

function prevImage() {
  if (currentImages.length === 0) return;
  currentIndex = (currentIndex - 1 + currentImages.length) % currentImages.length;
  updateModalImage();
}

function updateModalImage() {
  const img = document.getElementById('modal-image');
  const caption = document.getElementById('modal-caption');
  if (img && caption) {
    img.src = currentImages[currentIndex];
    caption.innerHTML = `<strong>${currentTitle}</strong><br>${currentDescription}`;
  }
}

const sections = document.querySelectorAll("section");

  const gradients = [
    "linear-gradient(to bottom, #0f2027, #203a43, #2c6064ff)",  
    "linear-gradient(to bottom, #0f2027,#125959ff, #02615cff)",         
    "linear-gradient(to bottom, #0f2027, #6c6539ff, #9a8d3aff)"            
  ];

  function changeBackground(index) {
    document.body.style.background = gradients[index];
  }

  function onScroll() {
    sections.forEach((section, i) => {
      const rect = section.getBoundingClientRect();
      if (rect.top <= window.innerHeight * 0.5 && rect.bottom >= window.innerHeight * 0.5) {
        changeBackground(i % gradients.length);
      }
    });
  }

  window.addEventListener("scroll", onScroll);
  window.addEventListener("load", onScroll);


  function renderProjects(data) {
  const groups = {};

  // گروه‌بندی پروژه‌ها بر اساس سکشن
  data.forEach(project => {
    const group = project.group.toLowerCase();
    if (!groups[group]) groups[group] = [];
    groups[group].push(project);
  });

  Object.keys(groups).forEach(group => {
    const container = document.getElementById(`${group}-projects`);
    if (!container) return;

    groups[group].forEach((project, index) => {
      const projectBox = document.createElement('div');
      projectBox.className = 'ui-projects';
      projectBox.style.setProperty('--delay', `${index * 0.4}s`);

      const imgDiv = document.createElement('div');
      imgDiv.className = 'ui__projects__img';

      const mainImg = document.createElement('img');
      mainImg.src = project.images[0];
      mainImg.alt = project.title;
      mainImg.className = 'img_projects popup-img';
      mainImg.addEventListener('click', () =>
        openModal(project.images, project.title, project.description, project.area)
      );
      imgDiv.appendChild(mainImg);

      const title = document.createElement('div');
      title.className = 'ui-projects_subtext';
      title.textContent = project.title;

      const desc = document.createElement('div');
      desc.className = 'projects_text';
      desc.textContent = project.description;

      const area = document.createElement('div');
      area.className = 'projects_text_area';
      area.textContent = project.area || '';

      projectBox.appendChild(imgDiv);
      projectBox.appendChild(title);
      projectBox.appendChild(desc);
      projectBox.appendChild(area);
      container.appendChild(projectBox);
    });
  });
}
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
      observer.unobserve(entry.target);
    }
  });
}, {
  threshold: 0.1  
});

function observeAllProjects() {
  const projectBoxes = document.querySelectorAll('.ui-projects');
  projectBoxes.forEach((box, index) => {
    box.style.setProperty('--delay', `${index * 0.1}s`);
    observer.observe(box);
  });
}

document.addEventListener('DOMContentLoaded', () => {
  renderProjects(projectsData);
  observeAllProjects(); // ⬅ مستقیم اجرا
});
